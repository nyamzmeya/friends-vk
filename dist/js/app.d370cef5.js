(function(){"use strict";var e={9700:function(e,t,n){var r=n(9242),o=n(3396);function s(e,t,n,r,s,i){const a=(0,o.up)("TabMenu"),l=(0,o.up)("router-view"),d=(0,o.up)("Panel");return(0,o.wg)(),(0,o.j4)(d,{header:"Сервис анализа друзей ВК"},{default:(0,o.w5)((()=>["friend"!=e.$route.name?((0,o.wg)(),(0,o.j4)(a,{key:0,model:e.items},null,8,["model"])):(0,o.kq)("",!0),(0,o.Wm)(l)])),_:1})}var i={name:"App",data:()=>({items:[{label:"Поиск пользователей",icon:"pi pi-fw pi-search",to:"/"},{label:"Список пользователей",icon:"pi pi-fw pi-users",to:"/persons"},{label:"Построить друзей",icon:"pi pi-fw pi-sitemap",to:"/friends"}]})},a=n(89);const l=(0,a.Z)(i,[["render",s]]);var d=l;function u(e,t,n,r,s,i){const a=(0,o.up)("Search"),l=(0,o.up)("Person");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(a),i.person?((0,o.wg)(),(0,o.j4)(l,{key:0,person:i.person},null,8,["person"])):(0,o.kq)("",!0)],64)}const c={class:"search"};function p(e,t,n,r,s,i){const a=(0,o.up)("InputText"),l=(0,o.up)("Button"),d=(0,o.up)("Alert");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",c,[(0,o.Wm)(a,{type:"text",modelValue:e.value,"onUpdate:modelValue":t[0]||(t[0]=t=>e.value=t)},null,8,["modelValue"]),(0,o.Wm)(l,{label:"Поиск",icon:"pi pi-check",loading:this.$store.getters.ISLOADING,onClick:i.getById},null,8,["loading","onClick"])]),i.alert?((0,o.wg)(),(0,o.j4)(d,{key:0,mes:i.alert.mes,type:i.alert.type},null,8,["mes","type"])):(0,o.kq)("",!0)],64)}var m=n(7139);function f(e,t,n,r,s,i){const a=(0,o.up)("Message");return(0,o.wg)(),(0,o.j4)(a,{severity:n.type,life:2e3,sticky:!1},{default:(0,o.w5)((()=>[(0,o.Uk)((0,m.zw)(n.mes),1)])),_:1},8,["severity"])}var _={name:"Alert",props:["mes","type"],mounted(){setTimeout((()=>{this.$store.commit("SET_ALERT_SEARCH",null)}),2e3)}};const g=(0,a.Z)(_,[["render",f]]);var h=g,E={components:{Alert:h},name:"Search",data:()=>({value:null}),computed:{alert(){return this.$store.getters.ALERT_SEARCH}},methods:{getById(){this.$store.dispatch("GET_CURRENTPERSON",this.value)}}};const v=(0,a.Z)(E,[["render",p]]);var S=v;const R=["src"],T={class:"person_info"};function w(e,t,n,r,s,i){const a=(0,o.up)("Button"),l=(0,o.up)("Card");return(0,o.wg)(),(0,o.j4)(l,{class:"person"},{header:(0,o.w5)((()=>[(0,o._)("img",{alt:"user header",src:n.person.photo_200_orig,class:"photo"},null,8,R)])),content:(0,o.w5)((()=>[(0,o._)("div",T,[(0,o._)("div",null,(0,m.zw)(n.person.first_name)+" "+(0,m.zw)(n.person.last_name),1),(0,o.Wm)(a,{icon:"pi pi-check",label:"Добавить",class:"p-button-sm",onClick:t[0]||(t[0]=e=>i.addPerson(n.person)),loading:this.$store.getters.ADDISLOADING,disabled:i.added},null,8,["loading","disabled"]),(0,o.Wm)(a,{class:"p-button-sm p-button-secondary",icon:"pi pi-trash",label:"Удалить",disabled:!i.added,onClick:t[1]||(t[1]=e=>i.deletePerson(n.person))},null,8,["disabled"])])])),_:1})}var N={name:"Person",props:["person"],computed:{added(){return this.person.added}},methods:{addPerson(e){this.$store.dispatch("ADD_PERSON_TO_LIST",e),this.$store.commit("SET_CURRENTPERSON",null),this.$store.commit("SET_ALERT_SEARCH",{mes:"Пользователь добавлен в список!",type:"success"}),setTimeout((()=>this.$store.commit("SET_ALERT_SEARCH",null)),2e3)},deletePerson(e){this.$store.commit("DELETE_PERSON",e)}},data:()=>({})};const y=(0,a.Z)(N,[["render",w]]);var D=y,P={name:"Home",computed:{person(){return this.$store.getters.CURRENTPERSON}},components:{Search:S,Person:D}};const O=(0,a.Z)(P,[["render",u]]);var A=O;const b={class:"persons"};function k(e,t,n,r,s,i){const a=(0,o.up)("Person"),l=(0,o.up)("Alert");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",b,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.persons,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id},[(0,o.Wm)(a,{person:e},null,8,["person"])])))),128))]),i.alert?((0,o.wg)(),(0,o.j4)(l,{key:0,mes:i.alert.mes,type:i.alert.type},null,8,["mes","type"])):(0,o.kq)("",!0)],64)}var I={components:{Alert:h,Person:D},name:"Persons",computed:{persons(){return this.$store.getters.PERSONS},alert(){return this.$store.getters.ALERT_PERSONS}}};const C=(0,a.Z)(I,[["render",k]]);var L=C;const F={key:0,class:"card"},$=["onClick"],U={class:"content"},j=["src"],Z={class:"name"},H=(0,o.Uk)(" Пол: "),G={key:0},x=(0,o.Uk)(" Возраст: "),M=(0,o.Uk)(" Всего друзей: "),W={class:"pi pi-users mr-4 p-text-secondary",style:{"font-size":"2rem"}};function z(e,t,n,r,s,i){const a=(0,o.up)("Tag"),l=(0,o.up)("Person"),d=(0,o.up)("DataView"),u=(0,o.up)("Alert"),c=(0,o.Q2)("badge"),p=(0,o.Q2)("tooltip");return 0!=i.friends.length?((0,o.wg)(),(0,o.iD)("div",F,[(0,o.Wm)(d,{onPage:i.changePage,value:i.friends,paginator:!0,layout:"grid",rows:4},(0,o.Nv)({grid:(0,o.w5)((({data:e})=>[this.friends_props?((0,o.wg)(),(0,o.j4)(l,{key:1,person:e},null,8,["person"])):((0,o.wg)(),(0,o.iD)("div",{key:0,class:"card_item",onClick:t=>i.goToFriendInfo(e)},[(0,o._)("div",{class:"card_content",style:(0,m.j5)([{backgroundColor:`rgba(233, 233, 255, ${e.friend_of.length/i.all_persons})`},{width:"250px"}])},[(0,o._)("div",U,[(0,o._)("img",{src:e.photo_200_orig},null,8,j),(0,o._)("div",Z,(0,m.zw)(e.first_name)+" "+(0,m.zw)(e.last_name),1),(0,o._)("div",null,[H,(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,m.zw)(1==e.sex?"Ж":2==e.sex?"М":"Пол не указан"),1)])),_:2},1024)]),e.age?((0,o.wg)(),(0,o.iD)("div",G,[x,(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,m.zw)(e.age),1)])),_:2},1024)])):(0,o.kq)("",!0),(0,o._)("div",null,[M,(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,m.zw)(e.friendsNum),1)])),_:2},1024)]),(0,o._)("div",null,[(0,o.wy)((0,o._)("i",W,null,512),[[c,e.friend_of.length],[p,e.friend_of.map((e=>e.first_name+" "+e.last_name)).join("\n"),void 0,{bottom:!0}]])])])],4)],8,$))])),_:2},[this.name?{name:"header",fn:(0,o.w5)((()=>[(0,o.Uk)(" Друзья "+(0,m.zw)(this.name),1)]))}:void 0]),1032,["onPage","value"])])):((0,o.wg)(),(0,o.j4)(u,{key:1,mes:"Пока друзей нет! Добавьте сначала пользователей"}))}var Y={components:{Alert:h,Person:D},name:"Friends",props:["friends_props","name"],mounted(){this.friends_props||0!=this.$store.getters.FRIENDS.length&&this.$store.dispatch("FETCH_FRIENDS_NUM",[0,4])},computed:{friends(){return this.friends_props||this.$store.getters.FRIENDS},all_persons(){return this.$store.getters.PERSONS.length}},methods:{changePage(e){console.log(e),this.$store.dispatch("FETCH_FRIENDS_NUM",[e.first,4])},goToFriendInfo(e){this.$router.push({path:`/friend/${e.id}`}),this.$store.commit("SET_CURRENTFRIEND",e)}}};const q=(0,a.Z)(Y,[["render",z]]);var B=q;function V(e,t,n,r,s,i){const a=(0,o.up)("Friends"),l=(0,o.up)("Posts");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(a,{friends_props:i.friends,name:i.name},null,8,["friends_props","name"]),(0,o.Wm)(l,{posts:i.posts,name:i.name},null,8,["posts","name"])],64)}n(6699);function Q(e,t,n,r,s,i){const a=(0,o.up)("Panel"),l=(0,o.up)("DataView");return(0,o.wg)(),(0,o.j4)(l,{value:n.posts,layout:"list",class:"posts"},{header:(0,o.w5)((()=>[(0,o.Uk)("Посты "+(0,m.zw)(n.name),1)])),list:(0,o.w5)((({data:e})=>[e.text?((0,o.wg)(),(0,o.j4)(a,{key:0,header:e.date},{default:(0,o.w5)((()=>[(0,o.Uk)((0,m.zw)(e.text),1)])),_:2},1032,["header"])):(0,o.kq)("",!0)])),_:1},8,["value"])}var K={name:"Posts",props:["posts","name"]};const J=(0,a.Z)(K,[["render",Q]]);var X=J,ee={name:"FriendInfo",components:{Friends:B,Posts:X},mounted(){this.$store.dispatch("GET_POSTS",this.$route.params.id)},computed:{friends(){let e=this.$store.getters.FRIENDS.filter((e=>e.id==this.$route.params.id)),t=this.$store.getters.PERSONS.filter((t=>e[0].friend_of.map((e=>e.id)).includes(t.id)));return t},posts(){return this.$store.getters.POSTS},name(){return this.$store.getters.CURRENTFRIEND.last_name+" "+this.$store.getters.CURRENTFRIEND.first_name}},data:()=>({items:[{label:"Друзья",icon:"pi pi-fw pi-search",to:"/friend/:id"}]})};const te=(0,a.Z)(ee,[["render",V]]);var ne=te,re=n(7535),oe=n(65);let se="208f0469208f0469208f04697d20f3a7fe2208f208f0469420d51770ede3e5d2ec735ce",ie={async getUserFriends(e){try{let t=await(0,re.R)(`https://api.vk.com/method/friends.get?user_id=${e}&order=name&fields=photo_200_orig,sex,bdate&access_token=${se}&v=5.131`);return t}catch(t){console.log(t)}},async getNumFriends(e){console.log(e);try{let t=await(0,re.R)(`https://api.vk.com/method/friends.get?user_id=${e}&access_token=${se}&v=5.131`);return t.response.count}catch(t){console.log(t)}},async getPosts(e){try{let t=await(0,re.R)(`https://api.vk.com/method/wall.get?owner_id=${e}&filter=owner&access_token=${se}&v=5.131`);return t.response.items}catch(t){console.log(t)}},async getCurrentPerson(e){try{let t=await(0,re.R)(`https://api.vk.com/method/users.get?user_id=${e}&fields=photo_200_orig&access_token=${se}&v=5.131`);return t}catch(t){console.log(t)}}};var ae=ie;function le(e){if(e.length<9)return null;let t=new Date,n=new Date(e.substring(e.length-4)),r=t.getFullYear()-n.getFullYear();return r}function de(e){let t=new Date(1e3*e);return t.getFullYear()+"."+t.getMonth()+"."+t.getDate()}var ue=(0,oe.MT)({state:{currentPerson:null,persons:[],friends:[],isLoading:!1,alert_persons:{mes:"Добавленных пользователей пока нет!",type:"warn"},alert_search:null,currentFriend:null,friend_posts:null,addIsLoading:!1},getters:{CURRENTPERSON:e=>e.currentPerson,PERSONS:e=>e.persons,ISLOADING:e=>e.isLoading,ADDISLOADING:e=>e.addIsLoading,ALERT_SEARCH:e=>e.alert_search,ALERT_PERSONS:e=>e.alert_persons,FRIENDS:e=>e.friends,POSTS:e=>e.friend_posts,CURRENTFRIEND:e=>e.currentFriend},mutations:{SET_CURRENTPERSON:(e,t)=>{e.currentPerson=t},ADD_PERSON:(e,t)=>{t.added=!0,e.persons.push(t),e.alert_persons=null},SET_LOADING:(e,t)=>{e.isLoading=t},SET_ADD_LOADING:(e,t)=>{e.addIsLoading=t},SET_ALERT_SEARCH:(e,t)=>{e.alert_search=t},SET_ALERT_PERSONS:(e,t)=>{e.alert_persons=t},DELETE_PERSON:(e,t)=>{e.currentPerson==t&&(e.currentPerson=null),e.persons=e.persons.filter((e=>e.id!=t.id)),e.friends=e.friends.filter((e=>1!=e.friend_of.length&&e.friend_of[0].id!=t.id)),e.alert_persons={mes:"Пользователь удален из списка!",type:"success"},e.alert_search=null},ADD_FRIENDS:(e,t)=>{t[0].forEach((n=>{let r=e.friends.findIndex((e=>e.id==n.id));-1!=r?e.friends[r].friend_of.push(t[1]):(n.friend_of=[],n.friend_of.push(t[1]),e.friends.push(n))})),e.friends=e.friends.sort(((e,t)=>e.last_name>t.last_name||e.last_name===t.last_name&&e.first_name>t.first_name?1:-1))},ADD_FRIENS_NUM:(e,t)=>{for(let n=0;n<=t[1].length-1;n++)e.friends[t[0]+n].friendsNum=t[1][n],e.friends[t[0]+n].age=e.friends[t[0]+n].bdate?le(e.friends[t[0]+n].bdate):null},SET_CURRENTFRIEND:(e,t)=>{e.currentFriend=t},ADD_FRIEND_POSTS:(e,t)=>{e.friend_posts=t}},actions:{GET_CURRENTPERSON:async(e,t)=>{e.commit("SET_LOADING",!0);let n=await ae.getCurrentPerson(t);return 0==n.response.length?(e.commit("SET_ALERT_SEARCH",{mes:"Упс! Кажется пользователя с таким id не существует",type:"warn"}),e.commit("SET_CURRENTPERSON",null),void e.commit("SET_LOADING",!1)):"deleted"==n.response[0].deactivated||"banned"==n.response[0].deactivated?(e.commit("SET_ALERT_SEARCH",{mes:"Упс! Кажется пользователь с таким id удален или забанен",type:"warn"}),e.commit("SET_CURRENTPERSON",null),void e.commit("SET_LOADING",!1)):n.response[0].is_closed?(e.commit("SET_ALERT_SEARCH",{mes:"Упс! Кажется профиль пользователя закрыт и мы не сможем добавить его друзей",type:"warn"}),e.commit("SET_CURRENTPERSON",null),void e.commit("SET_LOADING",!1)):e.state.persons.map((e=>e.id)).includes(n.response[0].id)?(e.commit("SET_ALERT_SEARCH",{mes:"Пользователь с таким id уже добавлен!",type:"warn"}),e.commit("SET_CURRENTPERSON",null),void e.commit("SET_LOADING",!1)):(e.commit("SET_ALERT_SEARCH",null),e.commit("SET_CURRENTPERSON",n.response[0]),void e.commit("SET_LOADING",!1))},ADD_PERSON_TO_LIST:async(e,t)=>{e.commit("ADD_PERSON",t),e.commit("SET_ADD_LOADING",!0);let n=await ae.getUserFriends(t.id);0!=n.response.items.length&&(n.response.items=n.response.items.filter((e=>!e.deactivated)),e.commit("ADD_FRIENDS",[n.response.items,{first_name:t.first_name,last_name:t.last_name,id:t.id}])),e.commit("SET_ADD_LOADING",!1)},FETCH_FRIENDS_NUM:async(e,t)=>{let n=await Promise.all(e.state.friends.slice(t[0],t[0]+t[1]).map((async e=>await ae.getNumFriends(e.id))));e.commit("ADD_FRIENS_NUM",[t[0],n])},GET_POSTS:async(e,t)=>{let n=await ae.getPosts(t);n=n.map((e=>(e.date=de(e.date),e))),e.commit("ADD_FRIEND_POSTS",n)}},modules:{}});async function ce(){const e=await n.e(461).then(n.t.bind(n,3657,23));e.load({google:{families:["Roboto:100,300,400,500,700,900&display=swap"]}})}var pe=n(7729),me=n(6709),fe=n(606),_e=n(1826),ge=n(5160),he=n(375),Ee=n(1349),ve=n(3717),Se=n(9203),Re=n(3235),Te=n(9947),we=n(1606),Ne=n(6171),ye=n(3585),De=n(8552),Pe=n(678);ce();const Oe=(0,r.ri)(d);Oe.use(ue),window.store=ue,Oe.use(pe.Z),Oe.component("InputText",me.Z),Oe.component("Card",fe.Z),Oe.component("Button",_e.Z),Oe.component("Message",ge.Z),Oe.component("TabMenu",he.Z),Oe.component("DataView",Ee.Z),Oe.component("Badge",we.Z),Oe.component("Column",ve.Z),Oe.component("Tag",Se.Z),Oe.component("Row",Re.Z),Oe.component("Panel",De.Z),Oe.component("Dropdown",Te.Z),Oe.directive("badge",Ne.Z),Oe.directive("tooltip",ye.Z);const Ae=[{path:"/",component:A},{path:"/persons",component:L},{path:"/friends",component:B},{path:"/friend/:id",name:"friend",component:ne}],be=(0,Pe.p7)({history:(0,Pe.r5)(),routes:Ae});Oe.use(be),Oe.mount("#app")}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.m=e,function(){var e=[];n.O=function(t,r,o,s){if(!r){var i=1/0;for(u=0;u<e.length;u++){r=e[u][0],o=e[u][1],s=e[u][2];for(var a=!0,l=0;l<r.length;l++)(!1&s||i>=s)&&Object.keys(n.O).every((function(e){return n.O[e](r[l])}))?r.splice(l--,1):(a=!1,s<i&&(i=s));if(a){e.splice(u--,1);var d=o();void 0!==d&&(t=d)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[r,o,s]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if("object"===typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var i={};e=e||[null,t({}),t([]),t(t)];for(var a=2&o&&r;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((function(e){i[e]=function(){return r[e]}}));return i["default"]=function(){return r},n.d(s,i),s}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))}}(),function(){n.u=function(e){return"js/webfontloader.3067ba56.js"}}(),function(){n.miniCssF=function(e){}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="vk-friends-test:";n.l=function(r,o,s,i){if(e[r])e[r].push(o);else{var a,l;if(void 0!==s)for(var d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var c=d[u];if(c.getAttribute("src")==r||c.getAttribute("data-webpack")==t+s){a=c;break}}a||(l=!0,a=document.createElement("script"),a.charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+s),a.src=r),e[r]=[o];var p=function(t,n){a.onerror=a.onload=null,clearTimeout(m);var o=e[r];if(delete e[r],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((function(e){return e(n)})),t)return t(n)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),l&&document.head.appendChild(a)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p="/friends-vk/"}(),function(){var e={143:0};n.f.j=function(t,r){var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else{var s=new Promise((function(n,r){o=e[t]=[n,r]}));r.push(o[2]=s);var i=n.p+n.u(t),a=new Error,l=function(r){if(n.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var s=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",a.name="ChunkLoadError",a.type=s,a.request=i,o[1](a)}};n.l(i,l,"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,s,i=r[0],a=r[1],l=r[2],d=0;if(i.some((function(t){return 0!==e[t]}))){for(o in a)n.o(a,o)&&(n.m[o]=a[o]);if(l)var u=l(n)}for(t&&t(r);d<i.length;d++)s=i[d],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(u)},r=self["webpackChunkvk_friends_test"]=self["webpackChunkvk_friends_test"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(9700)}));r=n.O(r)})();
//# sourceMappingURL=app.d370cef5.js.map