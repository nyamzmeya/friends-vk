(function(){"use strict";var e={2319:function(e,t,n){var r=n(9242),o=n(3396);function s(e,t,n,r,s,i){const a=(0,o.up)("TabMenu"),l=(0,o.up)("router-view"),u=(0,o.up)("Panel");return(0,o.wg)(),(0,o.j4)(u,{header:"Сервис анализа друзей ВК"},{default:(0,o.w5)((()=>["friend"!=e.$route.name?((0,o.wg)(),(0,o.j4)(a,{key:0,model:e.items},null,8,["model"])):(0,o.kq)("",!0),(0,o.Wm)(l)])),_:1})}var i={name:"App",data:()=>({items:[{label:"Поиск пользователей",icon:"pi pi-fw pi-search",to:"/"},{label:"Список пользователей",icon:"pi pi-fw pi-users",to:"/persons"},{label:"Построить друзей",icon:"pi pi-fw pi-sitemap",to:"/friends"}]})},a=n(89);const l=(0,a.Z)(i,[["render",s]]);var u=l;function c(e,t,n,r,s,i){const a=(0,o.up)("Search"),l=(0,o.up)("Person");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(a),i.person?((0,o.wg)(),(0,o.j4)(l,{key:0,person:i.person},null,8,["person"])):(0,o.kq)("",!0)],64)}const d={class:"search"};function p(e,t,n,r,s,i){const a=(0,o.up)("InputText"),l=(0,o.up)("Button"),u=(0,o.up)("Alert");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",d,[(0,o.Wm)(a,{type:"text",modelValue:e.value,"onUpdate:modelValue":t[0]||(t[0]=t=>e.value=t)},null,8,["modelValue"]),(0,o.Wm)(l,{label:"Поиск",icon:"pi pi-check",loading:this.$store.getters.ISLOADING,onClick:i.getById},null,8,["loading","onClick"])]),i.alert?((0,o.wg)(),(0,o.j4)(u,{key:0,mes:i.alert.mes,type:i.alert.type},null,8,["mes","type"])):(0,o.kq)("",!0)],64)}var m=n(7139);function f(e,t,n,r,s,i){const a=(0,o.up)("Message");return(0,o.wg)(),(0,o.j4)(a,{severity:n.type,life:2e3,sticky:!1},{default:(0,o.w5)((()=>[(0,o.Uk)((0,m.zw)(n.mes),1)])),_:1},8,["severity"])}var _={name:"Alert",props:["mes","type"]};const h=(0,a.Z)(_,[["render",f]]);var g=h,E={components:{Alert:g},name:"Search",data:()=>({value:null}),computed:{alert(){return this.$store.getters.ALERT_SEARCH}},methods:{getById(){this.$store.dispatch("GET_CURRENTPERSON",this.value)}}};const v=(0,a.Z)(E,[["render",p]]);var R=v;const S=["src"],w={class:"person_info"};function T(e,t,n,r,s,i){const a=(0,o.up)("Button"),l=(0,o.up)("Card");return(0,o.wg)(),(0,o.j4)(l,{class:"person"},{header:(0,o.w5)((()=>[(0,o._)("img",{alt:"user header",src:n.person.photo_200_orig,class:"photo"},null,8,S)])),content:(0,o.w5)((()=>[(0,o._)("div",w,[(0,o._)("div",null,(0,m.zw)(n.person.first_name)+" "+(0,m.zw)(n.person.last_name),1),(0,o.Wm)(a,{icon:"pi pi-check",label:"Добавить",class:"p-button-sm",onClick:t[0]||(t[0]=e=>i.addPerson(n.person)),disabled:i.added},null,8,["disabled"]),(0,o.Wm)(a,{class:"p-button-sm p-button-secondary",icon:"pi pi-trash",label:"Удалить",disabled:!i.added,onClick:t[1]||(t[1]=e=>i.deletePerson(n.person))},null,8,["disabled"])])])),_:1})}var y={name:"Person",props:["person"],computed:{added(){return this.person.added}},methods:{addPerson(e){this.$store.dispatch("ADD_PERSON_TO_LIST",e),this.$store.commit("SET_CURRENTPERSON",null),this.$store.commit("SET_ALERT_SEARCH",{mes:"Пользователь добавлен в список!",type:"success"}),setTimeout((()=>this.$store.commit("SET_ALERT_SEARCH",null)),2e3)},deletePerson(e){this.$store.commit("DELETE_PERSON",e)}},data:()=>({})};const N=(0,a.Z)(y,[["render",T]]);var P=N,b={name:"Home",computed:{person(){return this.$store.getters.CURRENTPERSON}},components:{Search:R,Person:P}};const D=(0,a.Z)(b,[["render",c]]);var O=D;function k(e,t,n,r,s,i){const a=(0,o.up)("Person"),l=(0,o.up)("Alert");return(0,o.wg)(),(0,o.iD)(o.HY,null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.persons,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id},[(0,o.Wm)(a,{person:e},null,8,["person"])])))),128)),i.alert?((0,o.wg)(),(0,o.j4)(l,{key:0,mes:i.alert.mes,type:i.alert.type},null,8,["mes","type"])):(0,o.kq)("",!0)],64)}var A={components:{Alert:g,Person:P},name:"Persons",computed:{persons(){return this.$store.getters.PERSONS},alert(){return this.$store.getters.ALERT_PERSONS}}};const C=(0,a.Z)(A,[["render",k]]);var F=C;const I={key:0,class:"card"},$=["onClick"],U={class:"content"},j=["src"],L={class:"name"},Z=(0,o.Uk)(" Пол: "),H={key:0},x=(0,o.Uk)(" Возраст: "),M=(0,o.Uk)(" Всего друзей: "),W={class:"pi pi-users mr-4 p-text-secondary",style:{"font-size":"2rem"}};function z(e,t,n,r,s,i){const a=(0,o.up)("Tag"),l=(0,o.up)("Person"),u=(0,o.up)("DataView"),c=(0,o.up)("Alert"),d=(0,o.Q2)("badge"),p=(0,o.Q2)("tooltip");return 0!=i.friends.length?((0,o.wg)(),(0,o.iD)("div",I,[(0,o.Wm)(u,{onPage:i.changePage,value:i.friends,paginator:!0,layout:"grid",rows:4},(0,o.Nv)({grid:(0,o.w5)((({data:e})=>[this.friends_props?((0,o.wg)(),(0,o.j4)(l,{key:1,person:e},null,8,["person"])):((0,o.wg)(),(0,o.iD)("div",{key:0,class:"card_item",onClick:t=>i.goToFriendInfo(e)},[(0,o._)("div",{class:"card_content",style:(0,m.j5)([{backgroundColor:`rgba(233, 233, 255, ${e.friend_of.length/i.all_persons})`},{width:"250px"}])},[(0,o._)("div",U,[(0,o._)("img",{src:e.photo_200_orig},null,8,j),(0,o._)("div",L,(0,m.zw)(e.first_name)+" "+(0,m.zw)(e.last_name),1),(0,o._)("div",null,[Z,(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,m.zw)(1==e.sex?"Ж":2==e.sex?"М":"Пол не указан"),1)])),_:2},1024)]),e.age?((0,o.wg)(),(0,o.iD)("div",H,[x,(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,m.zw)(e.age),1)])),_:2},1024)])):(0,o.kq)("",!0),(0,o._)("div",null,[M,(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,m.zw)(e.friendsNum),1)])),_:2},1024)]),(0,o._)("div",null,[(0,o.wy)((0,o._)("i",W,null,512),[[d,e.friend_of.length],[p,e.friend_of.map((e=>e.first_name+" "+e.last_name)).join("\n"),void 0,{bottom:!0}]])])])],4)],8,$))])),_:2},[this.name?{name:"header",fn:(0,o.w5)((()=>[(0,o.Uk)(" Друзья "+(0,m.zw)(this.name),1)]))}:void 0]),1032,["onPage","value"])])):((0,o.wg)(),(0,o.j4)(c,{key:1,mes:"Пока друзей нет! Добавьте сначала пользователей"}))}var G={components:{Alert:g,Person:P},name:"Friends",props:["friends_props","name"],mounted(){this.friends_props||0!=this.$store.getters.FRIENDS.length&&this.$store.dispatch("FETCH_FRIENDS_NUM",[0,4])},computed:{friends(){return this.friends_props||this.$store.getters.FRIENDS},all_persons(){return this.$store.getters.PERSONS.length}},methods:{changePage(e){console.log(e),this.$store.dispatch("FETCH_FRIENDS_NUM",[e.first,4])},goToFriendInfo(e){this.$router.push({path:`/friend/${e.id}`}),this.$store.commit("SET_CURRENTFRIEND",e)}}};const Y=(0,a.Z)(G,[["render",z]]);var q=Y;function B(e,t,n,r,s,i){const a=(0,o.up)("Friends"),l=(0,o.up)("Posts");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(a,{friends_props:i.friends,name:i.name},null,8,["friends_props","name"]),(0,o.Wm)(l,{posts:i.posts,name:i.name},null,8,["posts","name"])],64)}n(6699);function V(e,t,n,r,s,i){const a=(0,o.up)("Panel"),l=(0,o.up)("DataView");return(0,o.wg)(),(0,o.j4)(l,{value:n.posts,layout:"list",class:"posts"},{header:(0,o.w5)((()=>[(0,o.Uk)("Посты "+(0,m.zw)(n.name),1)])),list:(0,o.w5)((({data:e})=>[e.text?((0,o.wg)(),(0,o.j4)(a,{key:0,header:e.date},{default:(0,o.w5)((()=>[(0,o.Uk)((0,m.zw)(e.text),1)])),_:2},1032,["header"])):(0,o.kq)("",!0)])),_:1},8,["value"])}var Q={name:"Posts",props:["posts","name"]};const K=(0,a.Z)(Q,[["render",V]]);var J=K,X={name:"FriendInfo",components:{Friends:q,Posts:J},mounted(){this.$store.dispatch("GET_POSTS",this.$route.params.id)},computed:{friends(){let e=this.$store.getters.FRIENDS.filter((e=>e.id==this.$route.params.id)),t=this.$store.getters.PERSONS.filter((t=>e[0].friend_of.map((e=>e.id)).includes(t.id)));return t},posts(){return this.$store.getters.POSTS},name(){return this.$store.getters.CURRENTFRIEND.last_name+" "+this.$store.getters.CURRENTFRIEND.first_name}},data:()=>({items:[{label:"Друзья",icon:"pi pi-fw pi-search",to:"/friend/:id"}]})};const ee=(0,a.Z)(X,[["render",B]]);var te=ee,ne=n(7535),re=n(65);let oe="2df869b6453a45e5dc2bc064c7a15595aa33873c06deb17f4c50d0e57dc3a5474aa9687fbcd9dcfbfe72a",se={async getUserFriends(e){try{let t=await(0,ne.R)(`https://api.vk.com/method/friends.get?user_id=${e}&order=name&fields=photo_200_orig,sex,bdate&access_token=${oe}&v=5.131`);return t}catch(t){console.log(t)}},async getNumFriends(e){console.log(e);try{let t=await(0,ne.R)(`https://api.vk.com/method/users.get?user_id=${e}&fields=counters&access_token=${oe}&v=5.131`);return t.response[0].counters.friends}catch(t){console.log(t)}},async getPosts(e){try{let t=await(0,ne.R)(`https://api.vk.com/method/wall.get?owner_id=${e}&filter=owner&access_token=${oe}&v=5.131`);return t.response.items}catch(t){console.log(t)}},async getCurrentPerson(e){try{let t=await(0,ne.R)(`https://api.vk.com/method/users.get?user_id=${e}&fields=photo_200_orig&access_token=${oe}&v=5.131`);return t}catch(t){console.log(t)}}};var ie=se;function ae(e){if(e.length<9)return null;let t=new Date,n=new Date(e.substring(e.length-4)),r=t.getFullYear()-n.getFullYear();return r}function le(e){let t=new Date(1e3*e);return t.getFullYear()+"."+t.getMonth()+"."+t.getDate()}var ue=(0,re.MT)({state:{currentPerson:null,persons:[],friends:[],isLoading:!1,alert_persons:"Добавленных пользователей пока нет!",alert_search:null,currentFriend:null,friend_posts:null},getters:{CURRENTPERSON:e=>e.currentPerson,PERSONS:e=>e.persons,ISLOADING:e=>e.isLoading,ALERT_SEARCH:e=>e.alert_search,ALERT_PERSONS:e=>e.alert_persons,FRIENDS:e=>e.friends,POSTS:e=>e.friend_posts,CURRENTFRIEND:e=>e.currentFriend},mutations:{SET_CURRENTPERSON:(e,t)=>{e.currentPerson=t},ADD_PERSON:(e,t)=>{t.added=!0,e.persons.push(t),e.alert_persons=null},SET_LOADING:(e,t)=>{e.isLoading=t},SET_ALERT_SEARCH:(e,t)=>{e.alert_search=t},SET_ALERT_PERSONS:(e,t)=>{e.alert_persons=t},DELETE_PERSON:(e,t)=>{e.currentPerson==t&&(e.currentPerson=null),e.persons=e.persons.filter((e=>e.id!=t.id)),e.friends=e.friends.filter((e=>1!=e.friend_of.length&&e.friend_of[0].id!=t.id)),e.alert_persons={mes:"Пользователь удален из списка!",type:"success"},e.alert_search=null},ADD_FRIENDS:(e,t)=>{t[0].forEach((n=>{let r=e.friends.findIndex((e=>e.id==n.id));-1!=r?e.friends[r].friend_of.push(t[1]):(n.friend_of=[],n.friend_of.push(t[1]),e.friends.push(n))})),e.friends=e.friends.sort(((e,t)=>e.last_name>t.last_name||e.last_name===t.last_name&&e.first_name>t.first_name?1:-1))},ADD_FRIENS_NUM:(e,t)=>{for(let n=0;n<=t[1].length-1;n++)e.friends[t[0]+n].friendsNum=t[1][n],e.friends[t[0]+n].age=e.friends[t[0]+n].bdate?ae(e.friends[t[0]+n].bdate):null},SET_CURRENTFRIEND:(e,t)=>{e.currentFriend=t},ADD_FRIEND_POSTS:(e,t)=>{e.friend_posts=t}},actions:{GET_CURRENTPERSON:async(e,t)=>{e.commit("SET_LOADING",!0);let n=await ie.getCurrentPerson(t);if(0==n.response.length)return e.commit("SET_ALERT_SEARCH",{mes:"Упс! Кажется пользователя с таким id не существует",type:"warn"}),e.commit("SET_CURRENTPERSON",null),void e.commit("SET_LOADING",!1);"deleted"==n.response[0].deactivated?(e.commit("SET_ALERT_SEARCH",{mes:"Упс! Кажется пользователь с таким id удален",type:"warn"}),e.commit("SET_CURRENTPERSON",null)):n.response[0].is_closed?(e.commit("SET_ALERT_SEARCH",{mes:"Упс! Кажется профиль пользователя закрыт и мы не сможем добавить его друзей",type:"warn"}),e.commit("SET_CURRENTPERSON",null)):(e.commit("SET_ALERT_SEARCH",null),e.commit("SET_CURRENTPERSON",n.response[0])),e.commit("SET_LOADING",!1),e.commit("SET_ALERT_SEARCH",null)},ADD_PERSON_TO_LIST:async(e,t)=>{e.commit("ADD_PERSON",t),e.commit("SET_LOADING",!0);let n=await ie.getUserFriends(t.id);0!=n.response.items.length&&(n.response.items=n.response.items.filter((e=>!e.deactivated)),e.commit("ADD_FRIENDS",[n.response.items,{first_name:t.first_name,last_name:t.last_name,id:t.id}])),e.commit("SET_LOADING",!1)},FETCH_FRIENDS_NUM:async(e,t)=>{let n=await Promise.all(e.state.friends.slice(t[0],t[0]+t[1]).map((async e=>await ie.getNumFriends(e.id))));e.commit("ADD_FRIENS_NUM",[t[0],n])},GET_POSTS:async(e,t)=>{let n=await ie.getPosts(t);n=n.map((e=>(e.date=le(e.date),e))),e.commit("ADD_FRIEND_POSTS",n)}},modules:{}});async function ce(){const e=await n.e(461).then(n.t.bind(n,3657,23));e.load({google:{families:["Roboto:100,300,400,500,700,900&display=swap"]}})}var de=n(7729),pe=n(6709),me=n(606),fe=n(1826),_e=n(5160),he=n(375),ge=n(1349),Ee=n(3717),ve=n(9203),Re=n(3235),Se=n(9947),we=n(1606),Te=n(6171),ye=n(3585),Ne=n(8552),Pe=n(678);ce();const be=(0,r.ri)(u);be.use(ue),window.store=ue,be.use(de.Z),be.component("InputText",pe.Z),be.component("Card",me.Z),be.component("Button",fe.Z),be.component("Message",_e.Z),be.component("TabMenu",he.Z),be.component("DataView",ge.Z),be.component("Badge",we.Z),be.component("Column",Ee.Z),be.component("Tag",ve.Z),be.component("Row",Re.Z),be.component("Panel",Ne.Z),be.component("Dropdown",Se.Z),be.directive("badge",Te.Z),be.directive("tooltip",ye.Z);const De=[{path:"/",component:O},{path:"/persons",component:F},{path:"/friends",component:q},{path:"/friend/:id",name:"friend",component:te}],Oe=(0,Pe.p7)({history:(0,Pe.r5)(),routes:De});be.use(Oe),be.mount("#app")}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.m=e,function(){var e=[];n.O=function(t,r,o,s){if(!r){var i=1/0;for(c=0;c<e.length;c++){r=e[c][0],o=e[c][1],s=e[c][2];for(var a=!0,l=0;l<r.length;l++)(!1&s||i>=s)&&Object.keys(n.O).every((function(e){return n.O[e](r[l])}))?r.splice(l--,1):(a=!1,s<i&&(i=s));if(a){e.splice(c--,1);var u=o();void 0!==u&&(t=u)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[r,o,s]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if("object"===typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var i={};e=e||[null,t({}),t([]),t(t)];for(var a=2&o&&r;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((function(e){i[e]=function(){return r[e]}}));return i["default"]=function(){return r},n.d(s,i),s}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))}}(),function(){n.u=function(e){return"js/webfontloader.3067ba56.js"}}(),function(){n.miniCssF=function(e){}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="vk-friends-test:";n.l=function(r,o,s,i){if(e[r])e[r].push(o);else{var a,l;if(void 0!==s)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+s){a=d;break}}a||(l=!0,a=document.createElement("script"),a.charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+s),a.src=r),e[r]=[o];var p=function(t,n){a.onerror=a.onload=null,clearTimeout(m);var o=e[r];if(delete e[r],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((function(e){return e(n)})),t)return t(n)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),l&&document.head.appendChild(a)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p="/"}(),function(){var e={143:0};n.f.j=function(t,r){var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else{var s=new Promise((function(n,r){o=e[t]=[n,r]}));r.push(o[2]=s);var i=n.p+n.u(t),a=new Error,l=function(r){if(n.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var s=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",a.name="ChunkLoadError",a.type=s,a.request=i,o[1](a)}};n.l(i,l,"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,s,i=r[0],a=r[1],l=r[2],u=0;if(i.some((function(t){return 0!==e[t]}))){for(o in a)n.o(a,o)&&(n.m[o]=a[o]);if(l)var c=l(n)}for(t&&t(r);u<i.length;u++)s=i[u],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(c)},r=self["webpackChunkvk_friends_test"]=self["webpackChunkvk_friends_test"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(2319)}));r=n.O(r)})();
//# sourceMappingURL=app.45d6201e.js.map